# JSDoc Generation for AgentMark .prompt.mdx Files

This document explains the JSDoc generation feature that automatically creates JSDoc documentation for your `.prompt.mdx` files based on their input schemas, using the industry-standard [`json-schema-to-jsdoc`](https://www.npmjs.com/package/json-schema-to-jsdoc) package.

## Overview

The `generate-types` CLI command now supports generating JSDoc documentation alongside TypeScript types. This provides better IntelliSense support and documentation for your `.prompt.mdx` files, especially when working in MDX-aware editors.

## Features

✅ **Separate JSDoc File**: JSDoc lives in a separate `agentmark.jsdoc.js` file  
✅ **Schema-Based Generation**: Auto-generated from `input_schema` in each `.prompt.mdx` file  
✅ **Proper JSDoc Standards**: Uses `json-schema-to-jsdoc` package for industry-standard output  
✅ **MDX Compatible**: Generates proper `@typedef` definitions that can be referenced in MDX  
✅ **Type Safety**: Provides IntelliSense support for prompt properties  
✅ **Backward Compatible**: Works alongside existing TypeScript generation  

## Usage

### Basic Generation

Generate JSDoc documentation alongside TypeScript types:

```bash
# Generate both TypeScript and JSDoc
agentmark generate-types --root-dir ./prompts --generate-jsdoc

# TypeScript only (default behavior)
agentmark generate-types --root-dir ./prompts
```

### Example Input

Consider this `.prompt.mdx` file:

```mdx
---
name: user-greeting
input_schema:
  type: object
  properties:
    userName:
      type: string
      description: "The user's full name"
    age:
      type: integer
      description: "The user's age in years"
    interests:
      type: array
      items:
        type: string
      description: "List of user interests and hobbies"
  required:
    - userName
    - age
---

<s>
You are a friendly assistant that creates personalized greetings.
</s>

<User>
Hello! My name is {props.userName}, I am {props.age} years old, 
and I'm interested in {props.interests.join(', ')}.
</User>
```

### Generated JSDoc Output

The command generates `agentmark.jsdoc.js` with proper JSDoc typedefs:

```javascript
/**
 * Auto-generated JSDoc typedefs from AgentMark .prompt.mdx files
 * 
 * This file provides JSDoc @typedef documentation for all .prompt.mdx files in your project.
 * Each @typedef represents a prompt and documents its expected input parameters.
 * 
 * @fileoverview AgentMark JSDoc Type Definitions
 * @generated Do not edit this file directly
 */

/**
 * Props for user-greeting AgentMark prompt
 * @typedef {object} UserGreetingProps
 * @property {string} userName - The user's full name
 * @property {integer} age - The user's age in years
 * @property {string[]} [interests] - List of user interests and hobbies
 */

/**
 * All available AgentMark prompt prop types
 * @typedef {object} AgentMarkPromptTypes
 * @property {UserGreetingProps} "user-greeting.prompt.mdx" - Props for user-greeting.prompt.mdx
 */
```

### Using JSDoc in MDX Files

Reference the generated types in your `.prompt.mdx` files for better editor support:

```mdx
---
name: user-greeting
input_schema:
  # ... your schema
---

{/* Reference the JSDoc type for IntelliSense */}
{/** @typedef {import('./agentmark.jsdoc.js').UserGreetingProps} UserGreetingProps */}

<s>
You are a friendly assistant that creates personalized greetings.
</s>

<User>
{/* Now you get IntelliSense for props.userName, props.age, etc. */}
Hello! My name is {props.userName}, I am {props.age} years old, 
and I'm interested in {props.interests?.join(', ') || 'many things'}.
</User>
```

## Technical Details

### Package Used

This feature uses the [`json-schema-to-jsdoc`](https://www.npmjs.com/package/json-schema-to-jsdoc) package, which:

- Converts JSON Schema to proper JSDoc `@typedef` annotations
- Handles complex schema types like arrays, objects, and unions
- Supports schema descriptions and required properties
- Follows JSDoc standards for maximum compatibility

### Schema Support

Supports all JSON Schema features:

- **Basic types**: `string`, `number`, `integer`, `boolean`, `object`, `array`
- **Complex types**: Arrays with typed items, nested objects
- **Descriptions**: Property descriptions become JSDoc comments
- **Required fields**: Properly marked vs optional properties
- **Fallback handling**: Graceful handling of prompts without schemas

### File Structure

```
your-project/
├── prompts/
│   ├── user-greeting.prompt.mdx
│   ├── data-analysis.prompt.mdx
│   └── agentmark.jsdoc.js          # Generated JSDoc
└── agentmark.types.ts              # Generated TypeScript
```

## Editor Support

### VS Code

VS Code with MDX extensions will automatically pick up the JSDoc types when you:

1. Import the type using JSDoc syntax
2. Reference `props.*` in your MDX content
3. Get IntelliSense for property names and descriptions

### Other Editors

Any editor that supports JSDoc and MDX should provide similar functionality.

## CLI Options

```bash
agentmark generate-types [options]

Options:
  -l, --language <language>  Language to generate types for (default: "typescript")
  --local <port>            Local server port number
  --root-dir <path>         Root directory containing agentmark files
  --generate-jsdoc          Generate JSDoc documentation for .prompt.mdx files
  -h, --help               Display help for command
```

## Benefits

1. **Better Developer Experience**: IntelliSense support in MDX files
2. **Documentation**: Self-documenting prompt parameters
3. **Type Safety**: Catch property name typos early
4. **Standard Format**: Uses industry-standard JSDoc conventions
5. **Editor Agnostic**: Works with any JSDoc-supporting editor
6. **Zero Runtime Overhead**: Pure documentation, no runtime impact

## Example Workflow

1. **Define your prompt** with `input_schema` in the frontmatter
2. **Generate documentation**: `agentmark generate-types --generate-jsdoc`
3. **Reference types** in your MDX files using JSDoc imports
4. **Enjoy IntelliSense** while editing your prompts

This integration brings the same level of type safety and developer experience that you'd expect from modern TypeScript development to your AgentMark prompt files.